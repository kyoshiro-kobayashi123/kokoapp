<div class="timetable-container">
  <header class="timetable-header">
    <h1>教員用時間割</h1>
    <div class="week-switch">
      <%= link_to "＜ 先週", timetables_teacher_path(week: (@current_week - 7.days)) %>
      <span class="current-week"><%= @current_week.strftime("%-m月%-d日〜") %><%= (@current_week + 6.days).strftime("%-m月%-d日") %></span>
      <%= link_to "翌週 ＞", timetables_teacher_path(week: (@current_week + 7.days)) %>
    </div>
  </header>

  <table class="timetable">
    <thead>
      <tr>
        <th>時間帯</th>
        <th>月</th>
        <th>火</th>
        <th>水</th>
        <th>木</th>
        <th>金</th>
      </tr>
    </thead>
    <tbody>
      <% (1..3).each do |period| %>
        <tr>
          <td><%= "#{period}限" %></td>
          <% (1..5).each do |wday| %>
            <% entry = @entries.find { |e| e.period_id == period && e.wday == wday } %>
            <% color = entry&.subject&.color || "#fff" %>
            <td style="background-color:<%= color %>;">
              <% if entry %>
                <%= link_to entry.subject.subject_name, timetables_teacher_path, class: "cell-link" %>
              <% else %>
                -
              <% end %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>

  <div class="color-guide">
    <p><span class="color-box fixed"></span> 白：毎週固定授業</p>
    <p><span class="color-box changed"></span> 青：変更された授業</p>
    <p><span class="color-box exam"></span> 黒：試験</p>
    <p><span class="color-box event"></span> オレンジ：イベント</p>
  </div>
</div>
